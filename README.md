# bbystealer-malware-analysis
Reverse engineering and analysis for the bbystealer malware.

:warning:
**the malware directory contains malicious code, do not run in an unsandboxed environment**
:warning:

## Analysis techniques

- The use of filesystem auditing for dynamic analysis is documented in [filesystem-audit](./filesystem-audit).
- The process of deobfuscating bbystealer is documented in [deobfuscation](./deobfuscation).

## Context

Recently a strain of malware known as bbystealer has been infecting Discord users.

Victims are convinced to download and run a malicious executable through Discord messages.
Often, the attacker poses as a friend using a compromised Discord account.

Here is an example of an exchange between the attacker and a potential victim:

```
Attacker:   hey
            can you help me?

Victim:     yeah what up

Attacker:   I made my own game, called Owo Paradise. can you help to test and give me review?

Victim:     yeah sure

Attacker:   <FILE: OwOGame.exe>
            here
```

Anecdotally, the attacker has an unusually high rate of success compared to similar Discord malware campaigns.
This is largely due to the fact that conversations are handled by the attacker manually, unlike more typicall approaches where the process is automated.

## Behaviour

## Incident Response

These are recommended steps for those affected by bbystealer.

Note that these steps are based on the versions of bbystealer I analysed.
Capabilities differ between versions of this malware and these steps may not be sufficient for different versions.

### notify the potential next targets

If the victim loses control of their Discord account, it is important that they notify as many Discord contacts as possibly.
The malware spreads primarily due to trust between contacts and the fact that victims are not aware the person they are corresponding with has been infected.

### affected applications

Discord Installations:

- Discord
- Discord Canary
- DIscord Development
- Discord PTB
- Lightcord
- BetterDiscord

Browsers:

- Google Chrome
- Microsoft Edge
- Brave
- Opera
- Yandex

Cryptocurrency Wallets:

- MetaMask
- Exodus

### compromised credentials

Discord tokens from affected Discord installations are compromised.
The victim should immediately log out of all Discord clients to invalidate any stolen tokens.

All saved passwords and cookies stored in the affected browsers should be considered compromised.
Passwords must be changed.
Any accounts currently logged into an affected browser should be logged out to invalidate session cookies.

Private keys for affected cryptocurrency wallets may be compromised.
Any cryptocurrency secured by these private keys should be immediately transfered to an unaffected wallet.

### malware removal

Malicious code is injected in some Discord installations and will remain active.
A file used by these Discord installations is replaced by malicious code.
To ensure the removal of malicious code and restore normal functionality to Discord, affected installations should be completely removed and reinstalled.

The nexe executable downloads and saves its npm package dependencies to `%homedrive%%homepath%.nexe_natives\`.
This is unlikely to pose a security risk, but may be an undesired use of disk space for the victim.

## Summary
