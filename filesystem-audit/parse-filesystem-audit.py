#!/usr/bin/env python3

filename = "filesystem-audit.log"

items = []
current = None

with open(filename) as file:
    for line in file:
        # SKIP EMPTY LINES
        if len(line.strip()) == 0:
            pass

        # INFORMATION (START ITEM)
        if line.startswith("Information"):
            current = {
                    'accesses': [],
                    }

        # ACCESS MASK (END ITEM)
        elif line.startswith("\tAccess Mask:"):
            items.append(current)

        # ACESS REQUEST INFORMATION
        elif line.startswith("\tAccesses:") or line.startswith("\t\t\t\t"):
            access = line.removeprefix("\tAccesses:").strip()
            current["accesses"].append(access)

        # GENERAL
        elif line.startswith("\t"):
            split = line.split(':', 1)
            key = split[0].strip()
            value = split[1].strip()
            current[key] = value

for item in items:
    for key in item:
        print(key, item[key])
    print()
