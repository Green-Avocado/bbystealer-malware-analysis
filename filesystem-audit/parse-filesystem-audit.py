#!/usr/bin/env python3

filename = "filesystem-audit.log"

items = []
current = None
in_accesses = False

with open(filename) as file:
    for line in file:
        # INFORMATION
        if line.startswith("Information"):
            current = {
                    'accesses': [],
                    }
            pass

        elif line.strip().startswith("Access Mask:"):
            in_accesses = False
            items.append(current)
            pass

        elif len(line.strip()) == 0:
            pass

        # SUBJECT
        elif line.strip().startswith("Security ID:"):
            pass
        elif line.strip().startswith("Account Name:"):
            pass
        elif line.strip().startswith("Account Domain:"):
            pass
        elif line.strip().startswith("Login ID:"):
            pass

        # OBJECT
        elif line.strip().startswith("Object Server:"):
            pass
        elif line.strip().startswith("Object Type:"):
            pass
        elif line.strip().startswith("Object Name:"):
            pass
        elif line.strip().startswith("Handle ID:"):
            pass
        elif line.strip().startswith("Resource Attributes:"):
            pass

        # PROCESS INFORMATION
        elif line.strip().startswith("Process ID:"):
            pass
        elif line.strip().startswith("Process Name:"):
            pass

        # ACESS REQUEST INFORMATION
        elif line.strip().startswith("Accesses:") or in_accesses:
            access = line.strip().removeprefix("Accesses:").strip()
            current["accesses"].append(access)
            in_accesses = True
            pass

for item in items:
    print(item)
